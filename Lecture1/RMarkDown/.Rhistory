length(seq(from=0,to=T,by=T/n))
plot(seq(from=tick,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.02
r=0.06
sigma=0.3
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.055
r=0.06
sigma=0.3
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.055
r=0.06
sigma=0.3
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.055
r=0.06
sigma=0.3
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.055
r=0.06
sigma=0.3
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.06
r=0.06
sigma=0.4
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l")
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.06
r=0.06
sigma=0.4
### Paramètre de précision de la simulation
n = 1000 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l", lwd=2)
####### simulation d'une diffusion #######
### Paramètre de la diffusion
# On veut simuler : dVt/Vt=(r-delta)dt + sigma d Wt
delta=0.06
r=0.06
sigma=0.4
### Paramètre de précision de la simulation
n = 100 # nombre de pas
T = 1 # horizon temporel
V0= 100 # valeur initiale
V=rep(0,n+1)
V[1]=V0
tick=T/n
for (i in (2:(n+1)))
{
V[i]=V[i-1]*(1+(r-delta)*(tick)+sigma*rnorm(1,0,tick))
}
plot(seq(from=0,to=T,by=T/n), V, type="l", lwd=2)
install.packages("pander")
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
pander(summary(cars), justify=center)
pander(summary(cars), justify="center")
library(xtable)
library(xtable)
install.packages("googleVis")
pressure
M <- gvisMotionChart(pressure, 'Fruit', 'Year',
options=list(width=400, height=350))
plot(M)
library(googleVis)
op <- options(gvis.plot.tag='chart')
M <- gvisMotionChart(pressure, 'Fruit', 'Year',
options=list(width=400, height=350))
plot(M)
M <- gvisLineChart(pressure, 'Fruit', 'Year',
options=list(width=400, height=350))
plot(M)
M <- gvisLineChart(pressure)
plot(M)
CityPopularity$Mean=mean(CityPopularity$Popularity)
CC <- gvisComboChart(CityPopularity, xvar='City',
yvar=c('Mean', 'Popularity'),
options=list(seriesType='bars',
width=450, height=300,
title='City Popularity',
series='{0: {type:\"line\"}}'))
plot(CC)
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
## Add the mean
CityPopularity$Mean=mean(CityPopularity$Popularity)
CC <- gvisComboChart(CityPopularity, xvar='City',
yvar=c('Mean', 'Popularity'),
options=list(seriesType='bars',
width=450, height=300,
title='City Popularity',
series='{0: {type:\"line\"}}'))
plot(CC)
## Add the mean
CityPopularity$Mean=mean(CityPopularity$Popularity)
CC <- gvisComboChart(CityPopularity, xvar='City',
yvar=c('Mean', 'Popularity'),
options=list(seriesType='bars',
width=450, height=300,
title='City Popularity',
series='{0: {type:\"line\"}}'))
plot(CC)
setwd("~/Dropbox/01. Travail/07. Ponts/Lectures2018/Lecture1/RMarkDown")
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
library(googleVis)
op <- options(gvis.plot.tag='chart')
Bonds<-read.csv2("SARIVA_Bonds.csv" header=TRUE)
Bonds<-read.csv2("SARIVA_Bonds.csv", header=TRUE)
Bonds<-read.csv2("SARIVA_Bonds.csv", header=TRUE)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv")
pander(SARIVA_Bonds)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv")
pander(SARIVA_Bonds)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv")
pander(SARIVA_Bonds)
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
rownames(SARIVA_PaymentSchedule)=rownames(SARIVA_Bonds)
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]]<-100
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]+100*SARIVA_Bonds$Coupon.rate[i]
}
SARIVA_SARIVA_Bonds<-read.csv2("SARIVA_SARIVA_Bonds.csv")
pander(SARIVA_SARIVA_Bonds)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv")
pander(SARIVA_Bonds)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv")
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
dim(SARIVA_Bonds)[1]
ncol=max(SARIVA_Bonds$Maturity)
matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
max(SARIVA_Bonds$Maturity)
SARIVA_Bonds$Maturity)
SARIVA_Bonds$Maturity
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE)
pander(SARIVA_Bonds)
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
SARIVA_Bonds$Maturity)
SARIVA_Bonds$Maturity
SARIVA_Bonds
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE)
SARIVA_Bonds
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep="\t")
SARIVA_Bonds
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
rownames(SARIVA_PaymentSchedule)=rownames(SARIVA_Bonds)
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]]<-100
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]+100*SARIVA_Bonds$Coupon.rate[i]
}
pander(SARIVA_PaymentSchedule)
SARIVA_PaymentSchedule
apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Total<-data.frame(apply(-SARIVA_PaymentSchedule, 2, sum))
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(xvar=c(1:4),yvar=SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Total<-data.table(cbind(1:4,SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Total<-data.frame(cbind(1:4,SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(xvar=c(1:4),yvar=SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
plot(SARIVA_PaymentSchedule_Plot)
Interp_SARIVA_ZC_YC<-approx(rownames(RF_ZC_YC),SARIVA_ZC_YC)
SARIVA_ZC_YC<-(-(1/SARIVA_Bonds$Maturity)*log(SARIVA_ZC_BP))
pander(SARIVA_ZC_YC)
SARIVA_ZC_BP<-solve(SARIVA_PaymentSchedule)%*%SARIVA_Bonds$Price
pander(SARIVA_ZC_BP)
SARIVA_ZC_YC<-(-(1/SARIVA_Bonds$Maturity)*log(SARIVA_ZC_BP))
pander(SARIVA_ZC_YC)
Interp_RF_ZC_YC<-approx(RF_ZC_YC$Year,RF_ZC_YC$Coupon.rate)
RF_ZC_YC<-read.csv2("RF_ZC_YC.csv", header=TRUE)
Interp_RF_ZC_YC<-approx(RF_ZC_YC$Year,RF_ZC_YC$Coupon.rate)
Interp_SARIVA_ZC_YC<-approx(rownames(RF_ZC_YC),SARIVA_ZC_YC)
spread<-datatable(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
spread<-dataframe(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
spread<-data.frame(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
colnames(spread)<-c("Maturity", "Spread")
SARIVA_Spreads
Interp_RF_ZC_YC<-approx(RF_ZC_YC$Year,RF_ZC_YC$Coupon.rate)
Interp_SARIVA_ZC_YC<-approx(rownames(RF_ZC_YC),SARIVA_ZC_YC)
SARIVA_Spreads<-data.frame(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
SARIVA_Spreads
nterp_SARIVA_ZC_YC$y
Interp_SARIVA_ZC_YC$y
Interp_RF_ZC_YC$y
RF_ZC_YC$Coupon.rate
RF_ZC_YC
Interp_RF_ZC_YC<-approx(RF_ZC_YC$Year,RF_ZC_YC$Yield)
Interp_SARIVA_ZC_YC<-approx(rownames(RF_ZC_YC),SARIVA_ZC_YC)
SARIVA_Spreads<-data.frame(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
colnames(SARIVA_Spreads)<-c("Maturity", "Spread")
SARIVA_CumulativeProbabilityOfDefault<-data.fram(cbind(SARIVA_Spreads[,1],1-exp(-spread[,2]*spread[,1])))
SARIVA_CumulativeProbabilityOfDefault<-data.frame(cbind(SARIVA_Spreads[,1],1-exp(-spread[,2]*spread[,1])))
SARIVA_CumulativeProbabilityOfDefault_Plot<-gvisLineChart(SARIVA_CumulativeProbabilityOfDefault)
plot(SARIVA_CumulativeProbabilityOfDefault_Plot)
SARIVA_NewBond_CashFlows<-data.table(cbind(c(1,2,3,4),c(10, 10, 70, 7, 147)))
SARIVA_NewBond_CashFlows<-data.frame(cbind(c(1,2,3,4),c(10, 10, 70, 7, 147)))
SARIVA_NewBond_CashFlows<-data.frame(cbind(c(1,2,3,4),c(10, 70, 7, 147)))
gvisColumnChart(SARIVA_NewBond_CashFlows)
SARIVA_ZC_YC
SARIVA_NewBond_CashFlows[2,]*
exp(-SARIVA_ZC_YC*(SARIVA_NewBond_CashFlows[1,]))
sum(SARIVA_NewBond_CashFlows[2,]
)
SARIVA_NewBond_CashFlows[2,]
sum(SARIVA_NewBond_CashFlows[,2]*exp(-SARIVA_ZC_YC*(SARIVA_NewBond_CashFlows[,1])))
SARIVA_NewBond_Price<-sum(SARIVA_NewBond_CashFlows[,2]*exp(-SARIVA_ZC_YC*(SARIVA_NewBond_CashFlows[,1])))
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
library(googleVis)
op <- options(gvis.plot.tag='chart')
RF_ZC_YC<-read.csv2("RF_ZC_YC.csv", header=TRUE)
pander(RF_ZC_YC)
RF_ZC_YC_Plot<-gvisLineChart(RF_ZC_YC)
plot(RF_ZC_YC_Plot)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep="\p")
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep=";")
pander(SARIVA_Bonds)
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
SARIVA_Bonds
SARIVA_Bonds
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep="\t")
pander(SARIVA_Bonds)
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
rownames(SARIVA_PaymentSchedule)=rownames(SARIVA_Bonds)
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]]<-100
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]+100*SARIVA_Bonds$Coupon.rate[i]
}
pander(SARIVA_PaymentSchedule)
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total<-data.frame(cbind(1:4,SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
plot(SARIVA_PaymentSchedule_Plot)
SARIVA_ZC_BP<-solve(SARIVA_PaymentSchedule)%*%SARIVA_Bonds$Price
pander(SARIVA_ZC_BP)
SARIVA_ZC_YC<-(-(1/SARIVA_Bonds$Maturity)*log(SARIVA_ZC_BP))
pander(SARIVA_ZC_YC)
Interp_RF_ZC_YC<-approx(RF_ZC_YC$Year,RF_ZC_YC$Yield)
Interp_SARIVA_ZC_YC<-approx(rownames(RF_ZC_YC),SARIVA_ZC_YC)
SARIVA_Spreads<-data.frame(cbind(Interp_RF_ZC_YC$x,Interp_SARIVA_ZC_YC$y-Interp_RF_ZC_YC$y))
colnames(SARIVA_Spreads)<-c("Maturity", "Spread")
SARIVA_Spreads_Plot<-gvisLineChart(SARIVA_Spreads)
plot(SARIVA_Spreads_Plot)
SARIVA_CumulativeProbabilityOfDefault<-data.frame(cbind(SARIVA_Spreads[,1],1-exp(-SARIVA_Spreads[,2]*SARIVA_Spreads[,1])))
SARIVA_CumulativeProbabilityOfDefault_Plot<-gvisLineChart(SARIVA_CumulativeProbabilityOfDefault)
plot(SARIVA_CumulativeProbabilityOfDefault_Plot)
SARIVA_NewBond_CashFlows<-data.frame(cbind(c(1,2,3,4),c(10, 70, 7, 147)))
SARIVA_NewBond_CashFlows_Plot<-gvisColumnChart(SARIVA_NewBond_CashFlows)
plot(SARIVA_NewBond_CashFlows_Plot)
SARIVA_NewBond_Price<-sum(SARIVA_NewBond_CashFlows[,2]*exp(-SARIVA_ZC_YC*(SARIVA_NewBond_CashFlows[,1])))
## Set options back to original options
options(op)
knit_with_parameters('~/Dropbox/01. Travail/07. Ponts/Lectures2018/Lecture1/RMarkDown/Bonds.Rmd')
knit_with_parameters('~/Dropbox/01. Travail/07. Ponts/Lectures2018/Lecture1/RMarkDown/Bonds.Rmd')
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
library(googleVis)
op <- options(gvis.plot.tag='chart')
RF_ZC_YC<-read.csv2("RF_ZC_YC.csv", header=TRUE)
pander(RF_ZC_YC)
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep="\t")
pander(SARIVA_Bonds)
SARIVA_PaymentSchedule<-matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity))
rownames(SARIVA_PaymentSchedule)=rownames(SARIVA_Bonds)
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]]<-100
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]+100*SARIVA_Bonds$Coupon.rate[i]
}
pander(SARIVA_PaymentSchedule)
rownames(SARIVA_PaymentSchedule)
rownames(SARIVA_Bonds)
SARIVA_Bonds
SARIVA_Bonds
print(SARIVA_Bonds)
rownames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Bonds
rownames(SARIVA_PaymentSchedule)
pander(SARIVA_PaymentSchedule)
SARIVA_ZC_BP<-solve(SARIVA_PaymentSchedule)%*%SARIVA_Bonds$Price
percent(SARIVA_ZC_BP)
library(scales)
install.packages("scales")
library(scales)
percent(SARIVA_ZC_BP)
pander(percent(data.table(SARIVA_ZC_YC)))
pander(percent(data.frame(SARIVA_ZC_YC)))
pander(percent(SARIVA_ZC_YC))
pander(percent(SARIVA_ZC_YC))
pander(SARIVA_ZC_YC*100)
pander(paste(SARIVA_ZC_YC*100,"%"))
paste(SARIVA_ZC_YC*100,"%")
RF_ZC_YC[,2]<-percent(RF_ZC_YC[,2])
pander(RF_ZC_YC)
library(scales) # to express values in percents
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
library(googleVis)
op <- options(gvis.plot.tag='chart')
RF_ZC_YC[,2]<-sprintf("%1.2f%%", 100*RF_ZC_YC[,2])
RF_ZC_YC[,2]<-sprintf("%1.2f%%", 100*RF_ZC_YC[,2])
RF_ZC_YC[,2]
RF_ZC_YC<-read.csv2("RF_ZC_YC.csv", header=TRUE)
sprintf("%1.2f%%", 100*RF_ZC_YC[,2])
RF_ZC_YC[,2]<-sprintf("%1.2f%%", 100*RF_ZC_YC[,2])
RF_ZC_YC
pander(RF_ZC_YC)
RF_ZC_YC$Yield[1]+RF_ZC_YC$Yield[2]
RF_ZC_YC[,2]<-percent(RF_ZC_YC[,2])
pander(RF_ZC_YC)
max(SARIVA_Bonds$Maturity-today)
today<-2018
max(SARIVA_Bonds$Maturity-today)
max(SARIVA_Bonds$Maturity-today)
SARIVA_Bonds$Maturity
SARIVA_Bonds<-read.csv2("SARIVA_Bonds.csv", header = TRUE, sep="\t")
pander(SARIVA_Bonds)
max(SARIVA_Bonds$Maturity-today)
nrow=dim(SARIVA_Bonds)[1]
dim(SARIVA_Bonds)[1]
matrix(0, nrow=dim(SARIVA_Bonds)[1], ncol=max(SARIVA_Bonds$Maturity-today))
rownames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Bonds
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]]<-SARIVA_Bonds$Nominal[i]
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]]+SARIVA_Bonds$Nominal[i]*SARIVA_Bonds$CouponRate[i]
pander(SARIVA_PaymentSchedule)
}
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]-today]<-SARIVA_Bonds$Nominal[i]
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]-today]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]-today]+SARIVA_Bonds$Nominal[i]*SARIVA_Bonds$CouponRate[i]
pander(SARIVA_PaymentSchedule)
}
SARIVA_Bonds$Maturity[i]-today
pander(SARIVA_PaymentSchedule)
for (i in 1:dim(SARIVA_Bonds)[1])
{
SARIVA_PaymentSchedule[i,SARIVA_Bonds$Maturity[i]-today]<-SARIVA_Bonds$Nominal[i]
SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]-today]<-SARIVA_PaymentSchedule[i,1:SARIVA_Bonds$Maturity[i]-today]+SARIVA_Bonds$Nominal[i]*SARIVA_Bonds$CouponRate[i]
pander(SARIVA_PaymentSchedule)
}
SARIVA_Bonds$Maturity
colnames(SARIVA_PaymentSchedule)=SARIVA_Bonds$Maturity
pander(SARIVA_PaymentSchedule)
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Total<-data.frame(cbind(1:4,SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Total<-data.frame(cbind(colnames(SARIVA_PaymentSchedule_Total),SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Total
colnames(SARIVA_PaymentSchedule)
cbind(colnames(SARIVA_PaymentSchedule),SARIVA_PaymentSchedule_Total)
data.frame(cbind(colnames(SARIVA_PaymentSchedule),SARIVA_PaymentSchedule_Total))
gvisColumnChart(SARIVA_PaymentSchedule_Tot
)
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
SARIVA_PaymentSchedule_Total
cbind(colnames(SARIVA_PaymentSchedule),SARIVA_PaymentSchedule_Total)
library(scales) # to express values in percents
knitr::opts_chunk$set(echo = TRUE)
library(pander)
panderOptions("digits", 2)
library(googleVis)
op <- options(gvis.plot.tag='chart')
today<-2018
SARIVA_PaymentSchedule_Total<-data.frame(cbind(colnames(SARIVA_PaymentSchedule),SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Total
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
plot(SARIVA_PaymentSchedule_Plot)
today:(max(SARIVA_Bonds$Maturity-today)
)
SARIVA_Bonds$Maturity
max(SARIVA_Bonds$Maturity)
today:max(SARIVA_Bonds$Maturity)
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total<-data.frame(cbind(today:max(SARIVA_Bonds$Maturity),SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Total<-apply(-SARIVA_PaymentSchedule, 2, sum)
SARIVA_PaymentSchedule_Total<-data.frame(cbind(1:4,SARIVA_PaymentSchedule_Total))
SARIVA_PaymentSchedule_Plot<-gvisColumnChart(SARIVA_PaymentSchedule_Total)
SARIVA_ZC_BP<-solve(SARIVA_PaymentSchedule)%*%SARIVA_Bonds$Price
colnames(SARIVA_ZC_BP)<-c("Maturity","Price")
colnames(SARIVA_ZC_BP)<-c("Price")
pander(SARIVA_ZC_BP)
SARIVA_CumulativeProbabilityOfDefault<-data.frame(cbind(SARIVA_Spreads[,1],1-exp(-SARIVA_Spreads[,2]*SARIVA_Spreads[,1])))
SARIVA_CumulativeProbabilityOfDefault
SARIVA_Spreads
RF_ZC_YC$Year
format(SARIVA_NewBond_Price, digits=2, big.mark=" ")
SARIVA_NewBond_Price
format(SARIVA_NewBond_Price/200, digits=2, big.mark=" ")
format(SARIVA_NewBond_Price/2, digits=2, big.mark=" ")
format(SARIVA_NewBond_Price, digits=2, big.mark=" ")
SARIVA_NewBond_Price
round(SARIVA_NewBond_Price,0)
SARIVA_NewBond_Price
SARIVA_NewBond_Price/2
